{{ define "main" }}

<!-- breadcrumb -->
<div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <h1>Programm</h1>
            </div>
            <div class="col-md-5">
                <ul class="breadcrumb">
                    <li><a href="/">Home</a></li>
                    <li>spielplan</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- programm -->
<section class="bar background-gray no-mb" id="programm">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="heading text-center">
                    <h2>{{ .Title }}</h2>
                </div>
                <p class="lead">Es spielt das Orchester der Schäftlarner Konzerte. Der Konzertbeginn ist um 19:00 Uhr. Der Einlass öffnet eine halbe Stunde vor Konzertbeginn. Änderungen vorbehalten.</p>
                
                {{ $year := .Params.year | default 2025 }}
                {{ $concerts := where .Site.RegularPages "Section" "konzerte" }}
                {{ $yearConcerts := where $concerts ".Params.year" $year }}
                {{ $sortedConcerts := sort $yearConcerts ".Params.order" }}
                
                {{ if $sortedConcerts }}
                <div class="col-md-14">
                    <div class="panel-group accordion" id="accordionThree">
                        {{ range $concerts := $sortedConcerts }}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a class="collapsed" href="#{{ .Params.collapse_id }}" data-toggle="collapse" data-parent="#accordionThree">
                                        {{ dateFormat "2. January 2006" .Params.date | replaceRE "January" "Januar" | replaceRE "February" "Februar" | replaceRE "March" "März" | replaceRE "April" "April" | replaceRE "May" "Mai" | replaceRE "June" "Juni" | replaceRE "July" "Juli" | replaceRE "August" "August" | replaceRE "September" "September" | replaceRE "October" "Oktober" | replaceRE "November" "November" | replaceRE "December" "Dezember" }}
                                        <i>/ <span style="text-transform: none;">{{ .Title }}</span></i>
                                    </a>
                                </h4>
                            </div>
                            <div id="{{ .Params.collapse_id }}" class="panel-collapse collapse{{ if eq .Params.collapse_id "collapse3c" }} in{{ end }}">
                                <div class="panel-body">
                                    {{ if .Params.program }}
                                    <p>
                                        {{ range .Params.program }}
                                        {{ . }}<br>
                                        {{ end }}
                                    </p>
                                    {{ end }}
                                    
                                    <p>
                                        {{ if .Params.artists }}
                                        {{ range $i, $artist := .Params.artists }}
                                            {{ if gt $i 0 }}; {{ end }}
                                            <a style="color:rgb(150,190,255);" href="{{ $artist.url }}">{{ $artist.name }}</a>{{ if $artist.instrument }}, {{ $artist.instrument }}{{ end }}
                                        {{ end }}<br>
                                        {{ end }}
                                        
                                        {{ if .Params.conductor }}
                                        Leitung: <a style="color:rgb(150,190,255);" href="{{ .Params.conductor.url }}">{{ .Params.conductor.name }}</a>
                                        {{ end }}
                                        
                                        <br><br>
                                        {{ if .Params.ticket_url }}
                                        <a style="font-style:oblique;font-size:1.05em;font-weight:800;" target="_blank" href="{{ .Params.ticket_url }}">
                                            Tickets für dieses Konzert sichern ab €&nbsp;25
                                        </a>
                                        {{ end }}
                                    </p>
                                </div>
                            </div>
                        </div>
                        {{ end }}
                    </div>
                </div>
                {{ else }}
                <p class="text-center">Keine Konzerte für das Jahr {{ $year }} gefunden.</p>
                {{ end }}
                
                <div class="row">
                    <div class="col-md-12 text-center" style="margin-top: 30px;">
                        <p><strong>Kartenvorverkauf:</strong> <a href="https://www.muenchenticket.de/event/schaeftlarner-konzerte-{{ $year }}-31548/" target="_blank">München-Ticket</a></p>
                        <p><strong>Abonnements:</strong> <a href="mailto:kontakt@schaeftlarner-konzerte.de?subject=Abonnementbestellung">kontakt@schaeftlarner-konzerte.de</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{{ end }}

{{ define "scripts" }}
<script>
$(document).ready(function() {
    // Check if there's a hash in the URL and open the corresponding accordion panel
    if (window.location.hash) {
        var hash = window.location.hash;
        var target = $(hash);
        if (target.length && target.hasClass('panel-collapse')) {
            // Close all panels first
            $('.panel-collapse').removeClass('in');
            // Open the target panel
            target.addClass('in');
            // Scroll to the panel
            $('html, body').animate({
                scrollTop: target.offset().top - 100
            }, 500);
        }
    }
});
</script>
{{ end }}